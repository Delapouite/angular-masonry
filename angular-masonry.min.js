/*!
 * angular-masonry 0.9.1
 * Pascal Hartig, weluse GmbH, http://weluse.de/
 * License: MIT
 */
!function(){"use strict";angular.module("wu.masonry",[]).controller("MasonryCtrl",["$scope","$element","$timeout",function(a,b,c){function d(a){a.addClass("loaded")}var e={},f=[],g=!1,h=this,i=null,j=null;this.scheduleTimeout=30,this.preserveOrder=!1,this.loadImages=!0,a.$on("masonry.created",function(){i=a.masonry}),this.scheduleMasonryOnce=function(){var a=arguments,b=f.filter(function(b){return b[0]===a[0]}).length>0;b||this.scheduleMasonry.apply(null,arguments)},this.scheduleMasonry=function(){j&&c.cancel(j),f.push([].slice.call(arguments)),j=c(function(){g||(f.forEach(function(a){i[a]()}),f=[])},this.scheduleTimeout)},this.appendBrick=function(a,b){function c(){0===Object.keys(e).length&&i.resize(),void 0===e[a]&&(e[a]=!0,d(b),i.appended(b))}function f(){h.scheduleMasonryOnce("layout")}function j(){c(),f()}g||(h.loadImages?h.preserveOrder?(c(),imagesLoaded(b,f)):imagesLoaded(b,j):j())},this.removeBrick=function(a,b){g||(delete e[a],i.remove(b),this.scheduleMasonryOnce("layout"))},this.destroy=function(){g=!0,i.destroy(),a.$emit("masonry.destroyed"),e=[]},this.reload=function(){i.layout(),a.$emit("masonry.reloaded")}}]).directive("masonry",function(){return{restrict:"AE",controller:"MasonryCtrl",scope:!0,link:{pre:function(a,b,c,d){var e=a.$eval(c.masonry||c.masonryOptions),f=angular.extend({itemSelector:c.itemSelector||".masonry-brick",columnWidth:parseInt(c.columnWidth,10)||c.columnWidth},e||{});a.masonry=new Masonry(b[0],f),d.scheduleTimeout=parseInt(c.scheduleTimeout,10)&&d.scheduleTimeout;var g=a.$eval(c.loadImages);d.loadImages=g!==!1;var h=a.$eval(c.preserveOrder);d.preserveOrder=h!==!1&&void 0!==c.preserveOrder;var i=a.$eval(c.reloadOnShow);i!==!1&&void 0!==c.reloadOnShow&&a.$watch(function(){return b.prop("offsetParent")},function(a,b){a&&!b&&d.reload()}),a.$emit("masonry.created",b),a.$on("$destroy",d.destroy)}}}}).directive("masonryBrick",function(){return{restrict:"AC",require:"^masonry",scope:!0,link:{pre:function(a,b,c,d){var e,f=a.$id;d.appendBrick(f,b),b.on("$destroy",function(){d.removeBrick(f,b)}),a.$on("masonry.reload",function(){d.scheduleMasonryOnce("reloadItems"),d.scheduleMasonryOnce("layout")}),a.$watch("$index",function(){void 0!==e&&e!==a.$index&&(d.scheduleMasonryOnce("reloadItems"),d.scheduleMasonryOnce("layout")),e=a.$index})}}}})}();